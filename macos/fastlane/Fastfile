default_platform(:ios)
build_number = 1000000000 + number_of_commits()

platform :ios do
  desc "Deploy a new alpha build to TestFlight"
  lane :alpha do
    Dir.chdir "../.." do
      sh("flutter", "clean")
      sh("flutter", "packages", "get")
      sh("flutter", "build", "macos", "--release", "--build-number=#{build_number}")
    end
    build_ios_app(scheme: "Runner")
    # upload_to_testflight(distribute_external: true, groups: 'Alpha')
  end
end
